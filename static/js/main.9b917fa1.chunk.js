(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){},185:function(e,t,n){},186:function(e,t,n){},187:function(e,t,n){},188:function(e,t,n){},189:function(e,t,n){},190:function(e,t,n){},191:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(52),c=n.n(o),i=n(8),l=n(26),s=n(87),u=(n(100),n(2)),m=n(3),d=n(5),h=n(4),p=n(6),f=n(20),g=n(27),E=function(){return r.a.createElement("div",{className:"logo"},r.a.createElement(f.b,{to:"/"},"KEYDOWN"))},b=function(e){return{type:"SHOW_LOGIN_FORM",payload:e}},v=function(e){return{type:"SHOW_SIGNUP_FORM",payload:e}},y=function(e){return{type:"SHOW_MOBILE_BUTTONS",payload:e}},S=n(68),O=n.n(S);n(85),n(180);O.a.initializeApp({apiKey:"AIzaSyBpuiUbM6r9pKhzKP6xHSSaANIEe_rwPrc",authDomain:"keyboard-game-64e45.firebaseapp.com",databaseURL:"https://keyboard-game-64e45.firebaseio.com",projectId:"keyboard-game-64e45",storageBucket:"keyboard-game-64e45.appspot.com",messagingSenderId:"697558300831"});var w=O.a,A=w.firestore(),N=function(){return function(e){w.auth().signOut().then(function(){e({type:"LOGOUT_SUCCESS"})})}},j=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).renderLogInAndSignUpBtn=function(){var e=n.props,t=e.showing,a=e.showLoginForm,o=e.showSignUpForm;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"log-in nav-button",onClick:function(){a(!0)},disabled:t.signUpForm},"Log In"),r.a.createElement("button",{className:"sigh-in nav-button",onClick:function(){o(!0)},disabled:t.loginForm},"Sign Up"))},n.renderLogOutBtn=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"log-out nav-button",onClick:n.props.logOut},"Log Out"))},n}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"buttons"},this.props.auth.uid?this.renderLogOutBtn():this.renderLogInAndSignUpBtn())}}]),t}(r.a.Component),k=Object(i.b)(function(e){return{auth:e.auth,showing:e.showing}},{showLoginForm:b,showSignUpForm:v,logOut:N})(j),C=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).renderLogInAndSignUpBtn=function(){var e=n.props,t=e.showLoginForm,a=e.showSignUpForm,o=e.showMobileButtons;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"mobile-btn",onClick:function(){o(!1),t(!0)}},"Log In"),r.a.createElement("button",{className:"mobile-btn",onClick:function(){o(!1),a(!0)}},"Sign Up"))},n.renderLogOutBtn=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"mobile-btn",onClick:n.props.logOut},"Log Out"))},n}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.auth;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"mobile-buttons"},e.uid?this.renderLogOutBtn():this.renderLogInAndSignUpBtn()))}}]),t}(r.a.Component),L=Object(i.b)(function(e){return{auth:e.auth,showing:e.showing}},{showLoginForm:b,showSignUpForm:v,logOut:N,showMobileButtons:y})(C),I=n(89),R=n.n(I),_=(n(185),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.checkAuthState()}},{key:"render",value:function(){var e=this.props,t=e.showing,n=e.showMobileButtons,a=e.auth;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"nav-bar"},r.a.createElement(E,null),a.name?r.a.createElement("div",{className:"greeting"},"Hi ! ",a.name):null,r.a.createElement("button",{className:"menu-button",disabled:t.loginForm||t.signUpForm,onClick:function(){var e=t.mobileButtons;n(!e)}},r.a.createElement("img",{src:R.a,alt:""})),r.a.createElement(k,null)),t.mobileButtons?r.a.createElement(L,null):null)}}]),t}(r.a.Component)),F=Object(i.b)(function(e){return{auth:e.auth,showing:e.showing}},{checkAuthState:function(){return function(e){w.auth().onAuthStateChanged(function(t){t?(e({type:"GET_USER_UID",payload:t.uid}),A.collection("users").doc(t.uid).get().then(function(t){t&&e({type:"GET_USER_NAME",payload:t.data().userName})})):e({type:"GET_USER_UID",payload:null})})}},showMobileButtons:y})(_),T=n(30),U=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={userName:"",email:"",password:"",comfirmPassword:""},n.changeInputState=function(e){n.setState(Object(T.a)({},e.target.name,e.target.value))},n.submitHandler=function(e){e.preventDefault(),n.props.signUp(n.state)},n.rendersSignupForm=function(){return r.a.createElement("div",{className:"auth-view"},r.a.createElement("div",{className:"auth-wrap"},r.a.createElement("form",{className:"signup-form",onSubmit:n.submitHandler},r.a.createElement("i",{className:"fas fa-times exit-btn",onClick:function(){n.props.showSignUpForm(!1)}}),r.a.createElement("div",null,r.a.createElement("label",null,"Name"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"userName",value:n.state.userName,onChange:n.changeInputState})),r.a.createElement("div",null,r.a.createElement("label",null,"E-mail"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"email",value:n.state.email,onChange:n.changeInputState})),r.a.createElement("div",null,r.a.createElement("label",null,"Password"),r.a.createElement("br",null),r.a.createElement("input",{type:"password",name:"password",value:n.state.password,onChange:n.changeInputState})),r.a.createElement("div",null,r.a.createElement("label",null,"Comfirm Your Password"),r.a.createElement("br",null),r.a.createElement("input",{type:"password",name:"comfirmPassword",value:n.state.comfirmPassword,onChange:n.changeInputState})),r.a.createElement("button",{className:"submit-btn"},"Sigh Up"),r.a.createElement("div",null,n.props.auth.authError?r.a.createElement("p",null,n.props.auth.authError):null))))},n}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.auth.uid?null:this.rendersSignupForm())}}]),t}(r.a.Component),x=Object(i.b)(function(e){return{signUpForm:e.signUpForm,auth:e.auth}},{showSignUpForm:v,signUp:function(e){return function(t){var n=e.userName,a=e.email,r=e.password,o=e.comfirmPassword;""!==n?r===o?w.auth().createUserWithEmailAndPassword(a,r).then(function(e){var r=e.user.uid;t({type:"STORE_USER_UID",payload:r}),A.collection("users").doc(r).set({userName:n,email:a})}).then(function(){t({type:"SIGH_UP_SUCCESS"})}).catch(function(e){t({type:"SIGH_UP_ERROR",payload:e.message})}):t({type:"SIGH_UP_ERROR",payload:"Please comfirm your password"}):t({type:"SIGH_UP_ERROR",payload:"Please enter your name"})}}})(U),D=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={email:"",password:""},n.changeInputState=function(e){n.setState(Object(T.a)({},e.target.name,e.target.value))},n.submitHandler=function(e){e.preventDefault(),n.props.logIn(n.state)},n.renderForm=function(){return r.a.createElement("div",{className:"auth-view"},r.a.createElement("div",{className:"auth-wrap"},r.a.createElement("form",{className:"login-form",onSubmit:n.submitHandler},r.a.createElement("i",{className:"fas fa-times exit-btn",onClick:function(){n.props.showLoginForm(!1)}}),r.a.createElement("div",null,r.a.createElement("label",null,"E-mail"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"email",onChange:n.changeInputState})),r.a.createElement("div",null,r.a.createElement("label",null,"Password"),r.a.createElement("br",null),r.a.createElement("input",{type:"password",name:"password",onChange:n.changeInputState})),r.a.createElement("button",{className:"submit-btn"},"Login"),r.a.createElement("div",null,n.props.auth.authError?r.a.createElement("p",null,n.props.auth.authError):null))))},n}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.auth.uid?null:this.renderForm())}}]),t}(r.a.Component),G=Object(i.b)(function(e){return{auth:e.auth}},{showLoginForm:b,logIn:function(e){return function(t){w.auth().signInWithEmailAndPassword(e.email,e.password).then(function(){w.auth().onAuthStateChanged(function(e){t({type:"LOGIN_SUCCESS"})})}).catch(function(e){t({type:"LOGIN_ERROR",payload:e})})}}})(D),P=(n(186),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.showing,t=e.signUpForm,n=e.loginForm;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(x,null),n&&r.a.createElement(G,null))}}]),t}(r.a.Component)),M=Object(i.b)(function(e){return{showing:e.showing}})(P),B=(n(187),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"banner"},r.a.createElement("div",{className:"enter-wrap"},r.a.createElement("div",{className:"enter-btn"},r.a.createElement(f.b,{to:"/select"},"Enter Game"))))}}]),t}(r.a.Component)),H=n(90),W=w.firestore(),Y=(n(188),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchSongList()}},{key:"renderSongList",value:function(){return this.props.songList.map(function(e){return r.a.createElement("div",{key:e.id,className:"song"},r.a.createElement("div",{className:"song-details"},r.a.createElement("div",{className:"song-title"},e.data.title),r.a.createElement("div",{className:"song-auth"},e.data.auth)),r.a.createElement("div",{className:"difficulty-wrap"},r.a.createElement(f.b,{to:"/game/".concat(e.id,"?easy")},r.a.createElement("button",{className:"difficulty easy",name:e.data.name},"EASY")),r.a.createElement(f.b,{to:"/game/".concat(e.id,"?normal")},r.a.createElement("button",{className:"difficulty normal",name:e.data.name},"NORMAL")),r.a.createElement(f.b,{to:"/game/".concat(e.id,"?hard")},r.a.createElement("button",{className:"difficulty hard",name:e.data.name},"HARD"))))})}},{key:"render",value:function(){return r.a.createElement("div",{className:"song-list-wrap"},r.a.createElement("div",{className:"song-list"},this.renderSongList()))}}]),t}(r.a.Component)),Q=Object(i.b)(function(e){return{songList:e.songList,playingSongData:e.playingSongData}},{fetchSongList:function(){return function(e){var t=[];W.collection("songList").orderBy("id").get().then(function(n){return n.forEach(function(n){t=[].concat(Object(H.a)(t),[{id:n.id,data:n.data()}]),e({type:"FETCH_SONG_LIST",payload:t})})})}}})(Y),Z=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return r.a.createElement("canvas",{id:"game-canvas",width:this.props.width,height:this.props.height})}}]),t}(r.a.Component),J=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return r.a.createElement("canvas",{ref:this.props.getCanvas,id:"player-canvas",width:this.props.width,height:this.props.height})}}]),t}(r.a.Component),q=function(e){return r.a.createElement("div",{className:"battle-board"},"Best Record",e.record.slice(0,1).map(function(e){return r.a.createElement("div",{className:"score-in-board",key:e.id},e.data.score)}))},K=function(){return r.a.createElement("div",{className:"battle-board"},"Socre",r.a.createElement("div",{className:"score-in-board current-socre"},"0"))},V=w.firestore(),z=function(e,t,n){return function(a){V.collection("songList").doc(e).collection(t).add(n).then(function(){a({type:"STORE_RECORD"})}).catch(function(e){console.log(e.message)})}},X=w.firestore(),$=function(e,t){return function(n){var a=[];X.collection("songList").doc(e).collection(t).orderBy("score","desc").limit(10).get().then(function(e){e.forEach(function(e){a.push({id:e.id,data:e.data()}),n({type:"FETCH_RANKING_RECORD",payload:a})})})}},ee=function(e,t){var n=JSON.parse(localStorage.rankingData);n[e]=t,localStorage.rankingData=JSON.stringify(n)},te=function(e,t,n){var a=document.querySelector("#player-canvas").getContext("2d"),r=18*n,o=13*n;a.beginPath(),a.moveTo(e*n,0),a.lineTo((e+1)*n,0),a.lineTo(r*t/4,o),a.lineTo(r*(t-1)/4,o),a.closePath(),a.fillStyle="rgba(255,255,255,0.1)",a.fill()},ne=function(e){document.querySelector("#player-canvas").getContext("2d").clearRect(0,0,18*e,13*e)},ae=function(e,t){var n=document.querySelector("#game-canvas").getContext("2d");n.clearRect(0,0,18*e,13*e);var a=18*e,r=13*e,o=0,c=setInterval(function(){0===t?o=0:o+=98,n.clearRect(0,0,18*e,13*e),n.rect(0,0,18*e,13*e),n.fillStyle="#1d1d1d",n.fill(),n.save(),n.beginPath(),n.translate(a/2,r/4),n.textAlign="center",n.font="".concat(e,"px Courier New"),n.fillStyle="#fff",n.fillText("You got ".concat(o," points!"),0,0),n.restore(),n.save(),n.beginPath(),n.translate(a/2,r/2),n.textAlign="center",n.font="".concat(e,"px Courier New"),n.fillStyle="#fff",n.fillText("Click to Ranking Page",0,0),n.restore(),o>=t&&clearInterval(c)},5)},re=function(){if(localStorage.rankingData){var e=JSON.parse(localStorage.rankingData),t=e.name,n=e.totalNotes,a=e.hitNotesA+e.hitNotesB+e.hitNotesC+e.hitNotesD,r=n-a,o=98*a,c=Math.round(a/n*100);return{name:t,total:n,hit:a,miss:r,score:o,accurate:c,rank:c>=90?"A":c>=80?"B":c>=70?"C":c>=60?"D":"E"}}},oe=function(e,t,n,a,r,o){var c=document.querySelector(".btn-d"),i=document.querySelector(".btn-f"),l=document.querySelector(".btn-k"),s=document.querySelector(".btn-l"),u=document.querySelector(".current-socre"),m=function(e,t,n){var a=0;return function(){if(e[0]){var o=e[0].centerPos.y;o>11*r&&o<13*r&&(a++,function(e,t){var n=document.querySelector("#player-canvas").getContext("2d"),a=18*t;n.save(),n.beginPath(),n.translate(a*e/4-a/8,12*t-12),n.fillStyle="#fff",n.textAlign="center",n.font="".concat(t,"px Courier New"),n.fillText("HIT",0,0),n.restore()}(t,r),ee(n,a),u.textContent=re().score)}}},d=m(e,1,"hitNotesA"),h=m(t,2,"hitNotesB"),p=m(n,3,"hitNotesC"),f=m(a,4,"hitNotesD"),g=function(e){switch(e.keyCode){case 68:c.classList.add("btn-d-active"),te(7,1,r),d();break;case 70:i.classList.add("btn-f-active"),te(8,2,r),h();break;case 75:l.classList.add("btn-k-active"),te(9,3,r),p();break;case 76:s.classList.add("btn-l-active"),te(10,4,r),f()}},E=function(e){switch(ne(r),e.keyCode){case 68:c.classList.remove("btn-d-active");break;case 70:i.classList.remove("btn-f-active");break;case 75:l.classList.remove("btn-k-active");break;case 76:s.classList.remove("btn-l-active")}};window.addEventListener("keydown",g,!1),window.addEventListener("keyup",E,!1),o.addEventListener("ended",function(){window.removeEventListener("keydown",g,!1),window.removeEventListener("keyup",E,!1)}),c.addEventListener("touchstart",function(){te(7,1,r),d()}),i.addEventListener("touchstart",function(){te(8,2,r),h()}),l.addEventListener("touchstart",function(){te(9,3,r),p()}),s.addEventListener("touchstart",function(){te(10,4,r),f()}),c.addEventListener("touchend",function(){ne(r)}),i.addEventListener("touchend",function(){ne(r)}),l.addEventListener("touchend",function(){ne(r)}),s.addEventListener("touchend",function(){ne(r)})},ce=function(e,t,n,a){n.play();var r=.8*e/5,o=0,c=0,i=100;"easy"===a&&(i/=2),"hard"===a&&(i*=2);var l=document.querySelector("#game-canvas").getContext("2d"),s=18*e,d=13*e,h=Math.atan2(d,s/2-2*e),p=Math.atan2(s/2*Math.tan(h),s/2/2),f=2*e*Math.tan(h);l.line=function(e,t,n,a,r){l.beginPath(),l.moveTo(e.x,e.y),l.lineTo(t.x,t.y),l.strokeStyle=n,l.shadowBlur=60,l.shadowColor=a,l.lineWidth=r,l.stroke()};var g=function e(t,n){Object(u.a)(this,e),this.x=t||0,this.y=n||0},E=function(){function t(n){Object(u.a)(this,t);var a={centerPos:new g(s/2,0),pos1:new g(-2*e,0),pos2:new g(-e,0),color:"#75d0f5",shadowColor:"#5ad0fa",height:e/5,speed:r};Object.assign(a,n),Object.assign(this,a)}return Object(m.a)(t,[{key:"render",value:function(){l.save(),l.beginPath(),l.translate(this.centerPos.x,this.centerPos.y),l.line(this.pos1,this.pos2,this.color,this.shadowColor,this.height),l.restore()}},{key:"update",value:function(){this.centerPos.y+=this.speed,0!==this.pos1.x&&0!==this.pos2.x?(this.pos1.x=(this.centerPos.y+f)/Math.tan(h)*(this.pos1.x/Math.abs(this.pos1.x)),this.pos2.x=(this.centerPos.y+f)/Math.tan(p)*(this.pos2.x/Math.abs(this.pos2.x))):(this.pos1.x=(this.centerPos.y+f)/Math.tan(p)*(this.pos1.x/Math.abs(this.pos1.x)),this.pos2.x=0)}}]),t}(),b=[],v=[],y=[],S=[],O=0,w=function(){l.clearRect(0,0,18*e,13*e),A(),b.forEach(function(e){return e.render()}),v.forEach(function(e){return e.render()}),y.forEach(function(e){return e.render()}),S.forEach(function(e){return e.render()})},A=function(){for(var t=0;t<5;t++)l.line({x:(t+7)*e,y:0},{x:18*e/4*t,y:13*e},"#000",null,1);l.beginPath(),l.moveTo(7*e,0),l.lineTo(11*e,0),l.lineTo(18*e,13*e),l.lineTo(0,13*e),l.closePath(),l.fillStyle="rgba(0,0,0,.8)",l.fill(),l.line({x:.5*e,y:12*e},{x:17.5*e,y:12*e},"rgba(142, 226, 163, 0.8)",null,2)},N=setInterval(function(){++o>115&&o%(6e3/i)===0&&t[++c].forEach(function(n,a){1===t[c][0]&&(b.push(new E),O++),1===t[c][1]&&(v.push(new E({pos1:new g(-e,0),pos2:new g(0,0),color:"#ff0000",shadowColor:"#ff5a5a"})),O++),1===t[c][2]&&(y.push(new E({pos1:new g(e,0),pos2:new g(0,0),color:"#83ff2b",shadowColor:"#6fd328"})),O++),1===t[c][3]&&(S.push(new E({pos1:new g(e,0),pos2:new g(2*e,0),color:"#ffff00",shadowColor:"#fcfc68"})),O++)}),b.forEach(function(e){return e.update()}),v.forEach(function(e){return e.update()}),y.forEach(function(e){return e.update()}),S.forEach(function(e){return e.update()}),b.forEach(function(e,t){e.centerPos.y>d&&b.splice(t,1)}),v.forEach(function(e,t){e.centerPos.y>d&&v.splice(t,1)}),y.forEach(function(e,t){e.centerPos.y>d&&y.splice(t,1)}),S.forEach(function(e,t){e.centerPos.y>d&&S.splice(t,1)}),ee("totalNotes",O/4),w()},10);return oe(b,v,y,S,e,n),function(){clearInterval(N),n.pause(),n.currentTime=0}},ie=(n(189),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={unit:0},n.getCanvas=r.a.createRef(),n.setCanvasSize=function(){var e;e=window.innerWidth>1024?Math.round(.022*window.innerWidth):window.innerWidth>720?Math.round(.033*window.innerWidth):Math.round(.04*window.innerWidth),n.setState({unit:e})},n.storeRecord=function(e,t){if(localStorage.rankingData&&re().name){var n=function(e){return e<10?"0".concat(e):e},a=new Date,r="".concat(a.getFullYear(),"/").concat(n(a.getMonth()+1),"/").concat(n(a.getDate())," ").concat(n(a.getHours()),":").concat(n(a.getMinutes())),o={name:re().name,rank:re().rank,score:re().score,time:r};z(e,t,o)}},n}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){this.setCanvasSize()}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match,a=t.location,r=t.fetchPlayingSongData,o=t.setInGameState,c=t.fetchRankingRecord,i=n.params.id,l=a.search.slice(1);r(i,l),c(i,l),function(e){var t=document.querySelector("#game-canvas").getContext("2d"),n=18*e,a=13*e;t.line=function(e,n,a,r,o){t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.strokeStyle=a,t.shadowBlur=60,t.shadowColor=r,t.lineWidth=o,t.stroke()};for(var r=0;r<5;r++)t.line({x:(r+7)*e,y:0},{x:18*e/4*r,y:13*e},"#000",null,1);t.beginPath(),t.moveTo(7*e,0),t.lineTo(11*e,0),t.lineTo(18*e,13*e),t.lineTo(0,13*e),t.closePath(),t.fillStyle="rgba(0,0,0,.8)",t.fill(),t.line({x:.5*e,y:12*e},{x:17.5*e,y:12*e},"rgba(142, 226, 163, 0.8)",null,2),t.save(),t.beginPath(),t.translate(n/2,a/2),t.textAlign="center",t.font="".concat(e,"px Courier New"),t.fillStyle="#fff",t.fillText("Click to Start",0,0),t.restore()}(this.state.unit);this.getCanvas.current.addEventListener("click",function t(){return o(!0),e.getCanvas.current.removeEventListener("click",t),!1})}},{key:"componentDidUpdate",value:function(){var e=this,t=this.props,n=t.game,a=t.match,r=t.location,o=t.setGameFinishState,c=t.auth,i=a.params.id,l=r.search.slice(1);if("error"===n.playingSongData&&function(e){var t=document.querySelector("#game-canvas").getContext("2d");t.clearRect(0,0,18*e,13*e),t.rect(0,0,18*e,13*e),t.fillStyle="#1d1d1d",t.fill();var n=18*e,a=13*e;t.save(),t.beginPath(),t.translate(n/2,a/2),t.textAlign="center",t.font="".concat(e,"px Courier New"),t.fillStyle="#fff",t.fillText("Coming Soon...",0,0),t.restore()}(this.state.unit),n.inGame&&n.playingSongData.audio&&!n.gameFinish){var s={name:c.name,totalNotes:0,hitNotesA:0,hitNotesB:0,hitNotesC:0,hitNotesD:0};localStorage.setItem("rankingData",JSON.stringify(s)),this.stopGame=ce(this.state.unit,n.playingSongData.beatData,n.playingSongData.audio,l),n.playingSongData.audio.addEventListener("ended",function(){var t=re().score;e.stopGame(),o(!0),ae(e.state.unit,t),e.storeRecord(i,l),e.getCanvas.current.addEventListener("click",function(){window.location.hash="#/ranking/".concat(a.params.id).concat(r.search)})})}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.setInGameState,n=e.setGameFinishState,a=e.game;t(!1),n(!1),a.inGame&&a.playingSongData&&this.stopGame()}},{key:"render",value:function(){var e=this.state.unit,t={margin:"".concat(13*e+31,"px 0 0 0"),width:"".concat(18*e+1,"px")};return r.a.createElement("div",{className:"game-view"},r.a.createElement("div",{className:"game-wrap"},r.a.createElement("div",{className:"battle"},r.a.createElement(q,{record:this.props.ranking.record}),r.a.createElement(K,null)),r.a.createElement("div",{className:"canvas-wrap"},r.a.createElement(Z,{width:18*e,height:13*e}),r.a.createElement(J,{width:18*e,height:13*e,getCanvas:this.getCanvas})),r.a.createElement("div",{className:"game-buttons",style:t},r.a.createElement("div",{className:"game-btn btn-d"},"D"),r.a.createElement("div",{className:"game-btn btn-f"},"F"),r.a.createElement("div",{className:"game-btn btn-k"},"K"),r.a.createElement("div",{className:"game-btn btn-l"},"L"))))}}]),t}(r.a.Component)),le=Object(i.b)(function(e){return{game:e.game,auth:e.auth,ranking:e.ranking}},{setInGameState:function(e){return{type:"SET_IN_GAME_STATE",payload:e}},fetchPlayingSongData:function(e,t){return function(n){var a={};V.collection("songList").doc(e).collection("gameData").get().then(function(e){e.forEach(function(e){a=Object.assign({audio:new Audio(e.data().url),beatData:JSON.parse(e.data()[t])}),n({type:"FETCH_PLAYING_SONG_DATA",payload:a})})}).catch(function(e){console.log("Error getting documents: ",e),n({type:"FETCH_PLAYING_SONG_DATA",payload:"error"})})}},setGameFinishState:function(e){return{type:"SET_GAME_FINISH_STATE",payload:e}},storeRecordToDB:z,fetchRankingRecord:$})(ie),se=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"current-ranking"},r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"TotalNotes"),r.a.createElement("div",null," ",re().total)),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"HIT"),r.a.createElement("div",null," ",re().hit)),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"MISS"),r.a.createElement("div",null," ",re().miss)),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"SCORE"),r.a.createElement("div",null," ",re().score)),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"ACCURATE"),r.a.createElement("div",null," ",re().accurate," %")),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"RANK"),r.a.createElement("div",null," ",re().rank))))},ue=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.rankingRecord.map(function(e){return r.a.createElement("div",{className:"record-board",key:e.id},r.a.createElement("div",{className:"record-item"}," ",e.data.name),r.a.createElement("div",{className:"record-item"}," ",e.data.score),r.a.createElement("div",{className:"record-item"}," ",e.data.rank),r.a.createElement("div",{className:"record-item"}," ",e.data.time))}))}}]),t}(r.a.Component),me=(n(190),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){localStorage.rankingData||(window.location.hash="#/");var e=this.props,t=e.match,n=e.location,a=e.fetchRankingRecord,r=n.search.slice(1);""!==r&&a(t.params.id,r)}},{key:"componentWillUnmount",value:function(){localStorage.removeItem("rankingData")}},{key:"render",value:function(){return r.a.createElement("div",{className:"ranking-view"},r.a.createElement("div",{className:"ranking-wrap"},localStorage.rankingData?r.a.createElement(se,null):null,r.a.createElement("div",{className:"record"},r.a.createElement("div",{className:"record-board title"},r.a.createElement("div",{className:"record-item"}," Name"),r.a.createElement("div",{className:"record-item"}," Score"),r.a.createElement("div",{className:"record-item"}," Rank"),r.a.createElement("div",{className:"record-item"}," Date")),r.a.createElement(ue,{rankingRecord:this.props.ranking.record}))))}}]),t}(r.a.Component)),de=Object(i.b)(function(e){return{rankingData:e.rankingData,auth:e.auth,ranking:e.ranking}},{fetchRankingRecord:$})(me),he=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a,null,r.a.createElement(F,null),r.a.createElement(M,null),r.a.createElement("div",null,r.a.createElement(g.a,{path:"/",exact:!0,component:B}),r.a.createElement(g.a,{path:"/select",component:Q}),r.a.createElement(g.a,{path:"/game/:id",component:le}),r.a.createElement(g.a,{path:"/ranking/:id",component:de})))}}]),t}(a.Component),pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_SONG_LIST":return t.payload;default:return e}},fe=n(7),ge={loginForm:!1,signUpForm:!1,mobileButtons:!1},Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_LOGIN_FORM":return Object(fe.a)({},e,{loginForm:t.payload});case"SHOW_SIGNUP_FORM":return Object(fe.a)({},e,{signUpForm:t.payload});case"SHOW_MOBILE_BUTTONS":return Object(fe.a)({},e,{mobileButtons:t.payload});case"LOGIN_SUCCESS":return Object(fe.a)({},e,{loginForm:!1});case"SIGH_UP_SUCCESS":return Object(fe.a)({},e,{signUpForm:!1});default:return e}},be={authError:null,uid:null,name:null},ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return Object(fe.a)({},e,{authError:"Login Failed"});case"LOGIN_SUCCESS":return e;case"SIGH_UP_SUCCESS":return Object(fe.a)({},e,{authError:null});case"SIGH_UP_ERROR":return Object(fe.a)({},e,{authError:t.payload});case"LOGOUT_SUCCESS":return Object(fe.a)({},e,{name:null});case"GET_USER_UID":return Object(fe.a)({},e,{uid:t.payload});case"GET_USER_NAME":return Object(fe.a)({},e,{name:t.payload});case"SHOW_LOGIN_FORM":case"SHOW_SIGNUP_FORM":return Object(fe.a)({},e,{authError:null});default:return e}},ye={record:[]},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_RANKING_RECORD":return Object(fe.a)({},e,{record:t.payload});default:return e}},Oe={inGame:!1,playingSongData:null,gameFinish:!1},we=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IN_GAME_STATE":return Object(fe.a)({},e,{inGame:t.payload});case"FETCH_PLAYING_SONG_DATA":return Object(fe.a)({},e,{playingSongData:t.payload});case"SET_GAME_FINISH_STATE":return Object(fe.a)({},e,{gameFinish:t.payload});default:return e}},Ae=Object(l.c)({auth:ve,showing:Ee,songList:pe,game:we,ranking:Se}),Ne=Object(l.d)(Ae,Object(l.a)(s.a));c.a.render(r.a.createElement(i.a,{store:Ne},r.a.createElement(he,null)),document.getElementById("root"))},89:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfjBQEOGipNUDWeAAAAzElEQVRo3u3YPQ5BURCG4fegQbTYALUrsQIhEdthA9bjLwoKomcBJCo01FfQkKuwiO8W33MWMDNnppgMmJmJBSBHnbwg9psTH2hyJRG9C1FgT0vYgV0gpiRMIM6wFYaHLVSYEEsmIGZMWVq+mZlZKgSgT5uiIPaTDUsYyjbChIRB4EZV2IF7hkQYHr5ZAl1hAqMA9OiIhnDNSli8mZlZalSZ8ZCsYw+mVGAh3QnnKTjTHaUDcICIi6wBZxr/Y3WNgqD6Fye+0v83MwP4AccbjaeK1AN/AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTA1LTAxVDEyOjI2OjQyKzAyOjAwVQ1LxwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wNS0wMVQxMjoyNjo0MiswMjowMCRQ83sAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC"},91:function(e,t,n){e.exports=n(191)}},[[91,1,2]]]);
//# sourceMappingURL=main.9b917fa1.chunk.js.map