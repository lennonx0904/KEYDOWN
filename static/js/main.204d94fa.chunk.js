(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){},185:function(e,t,a){},186:function(e,t,a){},187:function(e,t,a){},188:function(e,t,a){},189:function(e,t,a){},190:function(e,t,a){},191:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(52),c=a.n(o),i=a(7),l=a(26),s=a(87),u=(a(100),a(2)),m=a(3),d=a(5),h=a(4),p=a(6),g=a(20),f=a(27),E=function(){return r.a.createElement("div",{className:"logo"},r.a.createElement(g.b,{to:"/"}," KEYDOWN"))},b=function(e){return{type:"SHOW_LOGIN_FORM",payload:e}},v=function(e){return{type:"SHOW_SIGNUP_FORM",payload:e}},y=function(e){return{type:"SHOW_MOBILE_BUTTONS",payload:e}},S=a(68),O=a.n(S);a(85),a(180);O.a.initializeApp({apiKey:"AIzaSyBpuiUbM6r9pKhzKP6xHSSaANIEe_rwPrc",authDomain:"keyboard-game-64e45.firebaseapp.com",databaseURL:"https://keyboard-game-64e45.firebaseio.com",projectId:"keyboard-game-64e45",storageBucket:"keyboard-game-64e45.appspot.com",messagingSenderId:"697558300831"});var N=O.a,w=N.firestore(),A=function(){return function(e){N.auth().signOut().then(function(){e({type:"LOGOUT_SUCCESS"})})}},k=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).renderLogInAndSignUpBtn=function(){var e=a.props,t=e.showing,n=e.showLoginForm,o=e.showSignUpForm;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"log-in nav-button",onClick:function(){n(!0)},disabled:t.signUpForm},"Log In"),r.a.createElement("button",{className:"sigh-in nav-button",onClick:function(){o(!0)},disabled:t.loginForm},"Sign Up"))},a.renderLogOutBtn=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"log-out nav-button",onClick:a.props.logOut},"Log Out"))},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"buttons"},this.props.auth.uid?this.renderLogOutBtn():this.renderLogInAndSignUpBtn())}}]),t}(r.a.Component),j=Object(i.b)(function(e){return{auth:e.auth,showing:e.showing}},{showLoginForm:b,showSignUpForm:v,logOut:A})(k),C=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).renderLogInAndSignUpBtn=function(){var e=a.props,t=e.showLoginForm,n=e.showSignUpForm,o=e.showMobileButtons;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"mobile-btn",onClick:function(){o(!1),t(!0)}},"Log In"),r.a.createElement("button",{className:"mobile-btn",onClick:function(){o(!1),n(!0)}},"Sign Up"))},a.renderLogOutBtn=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"mobile-btn",onClick:a.props.logOut},"Log Out"))},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.auth;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"mobile-buttons"},e.uid?this.renderLogOutBtn():this.renderLogInAndSignUpBtn()))}}]),t}(r.a.Component),R=Object(i.b)(function(e){return{auth:e.auth,showing:e.showing}},{showLoginForm:b,showSignUpForm:v,logOut:A,showMobileButtons:y})(C),L=a(89),I=a.n(L),_=(a(185),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.checkAuthState()}},{key:"render",value:function(){var e=this.props,t=e.showing,a=e.showMobileButtons;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"nav-bar"},r.a.createElement(E,null),r.a.createElement("button",{className:"menu-button",disabled:t.loginForm||t.signUpForm,onClick:function(){var e=t.mobileButtons;a(!e)}},r.a.createElement("img",{src:I.a,alt:""})),r.a.createElement(j,null)),t.mobileButtons?r.a.createElement(R,null):null)}}]),t}(r.a.Component)),T=Object(i.b)(function(e){return{auth:e.auth,showing:e.showing}},{checkAuthState:function(){return function(e){N.auth().onAuthStateChanged(function(t){t?(e({type:"GET_USER_UID",payload:t.uid}),w.collection("users").doc(t.uid).get().then(function(t){t&&e({type:"GET_USER_NAME",payload:t.data().userName})})):e({type:"GET_USER_UID",payload:null})})}},showMobileButtons:y})(_),D=a(30),U=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={userName:"",email:"",password:"",comfirmPassword:""},a.changeInputState=function(e){a.setState(Object(D.a)({},e.target.name,e.target.value))},a.submitHandler=function(e){e.preventDefault(),a.props.signUp(a.state)},a.rendersSignupForm=function(){return r.a.createElement("div",{className:"auth-view"},r.a.createElement("div",{className:"auth-wrap"},r.a.createElement("form",{className:"signup-form",onSubmit:a.submitHandler},r.a.createElement("i",{className:"fas fa-times exit-btn",onClick:function(){a.props.showSignUpForm(!1)}}),r.a.createElement("div",null,r.a.createElement("label",null,"Name"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"userName",value:a.state.userName,onChange:a.changeInputState})),r.a.createElement("div",null,r.a.createElement("label",null,"E-mail"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"email",value:a.state.email,onChange:a.changeInputState})),r.a.createElement("div",null,r.a.createElement("label",null,"Password"),r.a.createElement("br",null),r.a.createElement("input",{type:"password",name:"password",value:a.state.password,onChange:a.changeInputState})),r.a.createElement("div",null,r.a.createElement("label",null,"Comfirm Your Password"),r.a.createElement("br",null),r.a.createElement("input",{type:"password",name:"comfirmPassword",value:a.state.comfirmPassword,onChange:a.changeInputState})),r.a.createElement("button",{className:"submit-btn"},"Sigh Up"),r.a.createElement("div",null,a.props.auth.authError?r.a.createElement("p",null,a.props.auth.authError):null))))},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.auth.uid?null:this.rendersSignupForm())}}]),t}(r.a.Component),F=Object(i.b)(function(e){return{signUpForm:e.signUpForm,auth:e.auth}},{showSignUpForm:v,signUp:function(e){return function(t){var a=e.userName,n=e.email,r=e.password,o=e.comfirmPassword;""!==a?r===o?N.auth().createUserWithEmailAndPassword(n,r).then(function(e){var r=e.user.uid;t({type:"STORE_USER_UID",payload:r}),w.collection("users").doc(r).set({userName:a,email:n})}).then(function(){t({type:"SIGH_UP_SUCCESS"})}).catch(function(e){t({type:"SIGH_UP_ERROR",payload:e.message})}):t({type:"SIGH_UP_ERROR",payload:"Please comfirm your password"}):t({type:"SIGH_UP_ERROR",payload:"Please enter your name"})}}})(U),x=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={email:"",password:""},a.changeInputState=function(e){a.setState(Object(D.a)({},e.target.name,e.target.value))},a.submitHandler=function(e){e.preventDefault(),a.props.logIn(a.state)},a.renderForm=function(){return r.a.createElement("div",{className:"auth-view"},r.a.createElement("div",{className:"auth-wrap"},r.a.createElement("form",{className:"login-form",onSubmit:a.submitHandler},r.a.createElement("i",{className:"fas fa-times exit-btn",onClick:function(){a.props.showLoginForm(!1)}}),r.a.createElement("div",null,r.a.createElement("label",null,"E-mail"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"email",onChange:a.changeInputState})),r.a.createElement("div",null,r.a.createElement("label",null,"Password"),r.a.createElement("br",null),r.a.createElement("input",{type:"password",name:"password",onChange:a.changeInputState})),r.a.createElement("button",{className:"submit-btn"},"Login"),r.a.createElement("div",null,a.props.auth.authError?r.a.createElement("p",null,a.props.auth.authError):null))))},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.auth.uid?null:this.renderForm())}}]),t}(r.a.Component),P=Object(i.b)(function(e){return{auth:e.auth}},{showLoginForm:b,logIn:function(e){return function(t){N.auth().signInWithEmailAndPassword(e.email,e.password).then(function(){N.auth().onAuthStateChanged(function(e){t({type:"LOGIN_SUCCESS"}),t({type:"STORE_USER_UID",payload:e.uid})})}).catch(function(e){t({type:"LOGIN_ERROR",payload:e})})}}})(x),G=(a(186),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.showing,t=e.signUpForm,a=e.loginForm;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(F,null),a&&r.a.createElement(P,null))}}]),t}(r.a.Component)),M=Object(i.b)(function(e){return{showing:e.showing}})(G),B=(a(187),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"banner"},r.a.createElement("div",{className:"enter-wrap"},r.a.createElement("div",{className:"enter-btn"},r.a.createElement(g.b,{to:"/select"},"Enter Game"))))}}]),t}(r.a.Component)),H=a(90),W=N.firestore(),J=(a(188),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchSongList()}},{key:"renderSongList",value:function(){return this.props.songList.map(function(e){return r.a.createElement("div",{key:e.id,className:"song"},r.a.createElement("div",{className:"song-details"},r.a.createElement("div",{className:"song-title"},e.data.title),r.a.createElement("div",{className:"song-auth"},e.data.auth)),r.a.createElement("div",{className:"difficulty-wrap"},r.a.createElement(g.b,{to:"/game/".concat(e.id,"?easy")},r.a.createElement("button",{className:"difficulty easy",name:e.data.name},"EASY")),r.a.createElement(g.b,{to:"/game/".concat(e.id,"?normal")},r.a.createElement("button",{className:"difficulty normal",name:e.data.name},"NORMAL")),r.a.createElement(g.b,{to:"/game/".concat(e.id,"?hard")},r.a.createElement("button",{className:"difficulty hard",name:e.data.name},"HARD"))))})}},{key:"render",value:function(){return r.a.createElement("div",{className:"song-list-wrap"},r.a.createElement("div",{className:"song-list"},this.renderSongList()))}}]),t}(r.a.Component)),Y=Object(i.b)(function(e){return{songList:e.songList,playingSongData:e.playingSongData}},{fetchSongList:function(){return function(e){var t=[];W.collection("songList").orderBy("id").get().then(function(a){return a.forEach(function(a){t=[].concat(Object(H.a)(t),[{id:a.id,data:a.data()}]),e({type:"FETCH_SONG_LIST",payload:t})})})}}})(J),Q=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return r.a.createElement("canvas",{id:"game-canvas",width:this.props.width,height:this.props.height})}}]),t}(r.a.Component),Z=function(e){return r.a.createElement("div",{className:"battle-board"},"Best Record",e.record.slice(0,1).map(function(e){return r.a.createElement("div",{className:"score-in-board",key:e.id},e.data.score)}))},q=function(){return r.a.createElement("div",{className:"battle-board"},"Socre",r.a.createElement("div",{className:"score-in-board current-socre"},"0"))},K=N.firestore(),V=N.firestore(),z=function(e,t){return function(a){var n=[];V.collection("songList").doc(e).collection(t).orderBy("score","desc").limit(10).get().then(function(e){e.forEach(function(e){n.push({id:e.id,data:e.data()}),a({type:"FETCH_RANKING_RECORD",payload:n})})})}},X=function(e,t){var a=JSON.parse(localStorage.rankingData);a[e]=t,localStorage.rankingData=JSON.stringify(a)},$=function(e,t,a,n,r,o){var c=document.querySelector(".player-canvas").getContext("2d"),i=18*r,l=13*r;c.beginPath(),c.moveTo(e*r,0),c.lineTo(t*r,0),c.lineTo(i*a/4,l),c.lineTo(i*n/4,l),c.closePath(),c.fillStyle=o,c.fill()},ee=function(e){document.querySelector(".player-canvas").getContext("2d").clearRect(0,0,18*e,13*e)},te=function(e,t){var a=document.querySelector("#game-canvas").getContext("2d");a.clearRect(0,0,18*e,13*e);var n=18*e,r=13*e,o=0,c=setInterval(function(){0===t?o=0:o+=98,a.clearRect(0,0,18*e,13*e),a.rect(0,0,18*e,13*e),a.fillStyle="#1d1d1d",a.fill(),a.save(),a.beginPath(),a.translate(n/2,r/4),a.textAlign="center",a.font="".concat(e,"px Courier New"),a.fillStyle="#fff",a.fillText("You got ".concat(o," points!"),0,0),a.restore(),a.save(),a.beginPath(),a.translate(n/2,r/2),a.textAlign="center",a.font="".concat(e,"px Courier New"),a.fillStyle="#fff",a.fillText("Click to Ranking Page",0,0),a.restore(),o>=t&&clearInterval(c)},5)},ae=function(){if(localStorage.rankingData){var e=JSON.parse(localStorage.rankingData),t=e.totalNotes,a=e.hitNotesA+e.hitNotesB+e.hitNotesC+e.hitNotesD,n=Math.round(a/t*100);return n>=90?"A":n>=80?"B":n>=70?"C":n>=60?"D":"E"}},ne=function(e,t,a,n,r,o){var c=document.querySelector(".btn-d"),i=document.querySelector(".btn-f"),l=document.querySelector(".btn-k"),s=document.querySelector(".btn-l"),u=document.querySelector(".current-socre"),m=function(e,t,a){var n=0;return function(){e[0]&&e[0].centerPos.y>11*r&&e[0].centerPos.y<13*r&&(e[0].color="#000000",e[0].shadowColor="#000000",e[0].height=30,n++,function(e,t){var a=document.querySelector(".player-canvas").getContext("2d"),n=18*t;a.save(),a.beginPath(),a.translate(n*e/4-n/8,12*t-12),a.fillStyle="#fff",a.textAlign="center",a.font="".concat(t,"px Courier New"),a.fillText("HIT",0,0),a.restore()}(t,r),X(a,n),u.textContent=function(){if(localStorage.rankingData){var e=JSON.parse(localStorage.rankingData);return 98*(e.hitNotesA+e.hitNotesB+e.hitNotesC+e.hitNotesD)}}())}},d=m(e,1,"hitNotesA"),h=m(t,2,"hitNotesB"),p=m(a,3,"hitNotesC"),g=m(n,4,"hitNotesD"),f=function(e){switch(e.keyCode){case 68:c.classList.add("btn-d-active"),$(7,8,1,0,r,"rgba(255,255,255,0.1)"),d();break;case 70:i.classList.add("btn-f-active"),$(8,9,2,1,r,"rgba(255,255,255,0.1)"),h();break;case 75:l.classList.add("btn-k-active"),$(9,10,3,2,r,"rgba(255,255,255,0.1)"),p();break;case 76:s.classList.add("btn-l-active"),$(10,11,4,3,r,"rgba(255,255,255,0.1)"),g()}},E=function(e){switch(e.keyCode){case 68:c.classList.remove("btn-d-active"),ee(r);break;case 70:i.classList.remove("btn-f-active"),ee(r);break;case 75:l.classList.remove("btn-k-active"),ee(r);break;case 76:s.classList.remove("btn-l-active"),ee(r)}};window.addEventListener("keydown",f,!1),window.addEventListener("keyup",E,!1),o.addEventListener("ended",function(){window.removeEventListener("keydown",f,!1),window.removeEventListener("keyup",E,!1)}),c.addEventListener("touchstart",function(){$(7,8,1,0,r,"rgba(255,255,255,0.1)"),d()}),i.addEventListener("touchstart",function(){$(8,9,2,1,r,"rgba(255,255,255,0.1)"),h()}),l.addEventListener("touchstart",function(){$(9,10,3,2,r,"rgba(255,255,255,0.1)"),p()}),s.addEventListener("touchstart",function(){$(10,11,4,3,r,"rgba(255,255,255,0.1)"),g()}),c.addEventListener("touchend",function(){ee(r)}),i.addEventListener("touchend",function(){ee(r)}),l.addEventListener("touchend",function(){ee(r)}),s.addEventListener("touchend",function(){ee(r)})},re=function(e,t,a,n){a.play();var r=0,o=0,c=e/5,i=100;"easy"===n&&(i/=2,c*=.8),"hard"===n&&(i*=2);var l=document.querySelector("#game-canvas").getContext("2d"),s=18*e,d=13*e,h=Math.atan2(d,s/2-2*e),p=Math.atan2(s/2*Math.tan(h),s/2/2),g=2*e*Math.tan(h);l.line=function(e,t,a,n,r){l.beginPath(),l.moveTo(e.x,e.y),l.lineTo(t.x,t.y),l.strokeStyle=a,l.shadowBlur=60,l.shadowColor=n,l.lineWidth=r,l.stroke()};var f=function e(t,a){Object(u.a)(this,e),this.x=t||0,this.y=a||0},E=function(){function t(a){Object(u.a)(this,t);var n={centerPos:new f(s/2,0),pos1:new f(-2*e,0),pos2:new f(-e,0),color:"#75d0f5",shadowColor:"#5ad0fa",height:e/5,speed:c};Object.assign(n,a),Object.assign(this,n)}return Object(m.a)(t,[{key:"render",value:function(){l.save(),l.beginPath(),l.translate(this.centerPos.x,this.centerPos.y),l.line(this.pos1,this.pos2,this.color,this.shadowColor,this.height),l.restore()}},{key:"update",value:function(){this.centerPos.y+=this.speed,0!==this.pos1.x&&0!==this.pos2.x?(this.pos1.x=(this.centerPos.y+g)/Math.tan(h)*(this.pos1.x/Math.abs(this.pos1.x)),this.pos2.x=(this.centerPos.y+g)/Math.tan(p)*(this.pos2.x/Math.abs(this.pos2.x))):(this.pos1.x=(this.centerPos.y+g)/Math.tan(p)*(this.pos1.x/Math.abs(this.pos1.x)),this.pos2.x=0)}}]),t}(),b=[],v=[],y=[],S=[],O=0,N=function(){l.clearRect(0,0,18*e,13*e),w(),b.forEach(function(e){return e.render()}),v.forEach(function(e){return e.render()}),y.forEach(function(e){return e.render()}),S.forEach(function(e){return e.render()})},w=function(){for(var t=0;t<5;t++)l.line({x:(t+7)*e,y:0},{x:18*e/4*t,y:13*e},"#000",null,1);l.beginPath(),l.moveTo(7*e,0),l.lineTo(11*e,0),l.lineTo(18*e,13*e),l.lineTo(0,13*e),l.closePath(),l.fillStyle="rgba(0,0,0,.8)",l.fill(),l.line({x:.5*e,y:12*e},{x:17.5*e,y:12*e},"rgba(142, 226, 163, 0.8)",null,2)},A=setInterval(function(){++r>115&&r%(6e3/i)===0&&t[++o].forEach(function(a,n){1===t[o][0]&&(b.push(new E),O++),1===t[o][1]&&(v.push(new E({pos1:new f(-e,0),pos2:new f(0,0),color:"#ff0000",shadowColor:"#ff5a5a"})),O++),1===t[o][2]&&(y.push(new E({pos1:new f(e,0),pos2:new f(0,0),color:"#83ff2b",shadowColor:"#6fd328"})),O++),1===t[o][3]&&(S.push(new E({pos1:new f(e,0),pos2:new f(2*e,0),color:"#ffff00",shadowColor:"#fcfc68"})),O++)}),b.forEach(function(e){return e.update()}),v.forEach(function(e){return e.update()}),y.forEach(function(e){return e.update()}),S.forEach(function(e){return e.update()}),b.forEach(function(e,t){e.centerPos.y>d&&b.splice(t,1)}),v.forEach(function(e,t){e.centerPos.y>d&&v.splice(t,1)}),y.forEach(function(e,t){e.centerPos.y>d&&y.splice(t,1)}),S.forEach(function(e,t){e.centerPos.y>d&&S.splice(t,1)}),X("totalNotes",O/4),N()},10);return ne(b,v,y,S,e,a),function(){clearInterval(A),a.pause(),a.currentTime=0}},oe=(a(189),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={unit:0},a.setCanvasSize=function(){var e;e=window.innerWidth>1024?Math.round(.022*window.innerWidth):window.innerWidth>720?Math.round(.033*window.innerWidth):Math.round(.04*window.innerWidth),a.setState({unit:e})},a.countCurrentScore=function(){var e=JSON.parse(localStorage.rankingData);return 98*(e.hitNotesA+e.hitNotesB+e.hitNotesC+e.hitNotesD)},a.storeRecord=function(e){if(localStorage.rankingData){var t=a.props,n=t.match,r=t.location,o=t.storeRecordToDB,c=r.search.slice(1),i=JSON.parse(localStorage.rankingData),l=new Date,s="".concat(l.getFullYear(),"/").concat(l.getMonth()+1,"/").concat(l.getDate()," ").concat(l.getHours(),":").concat(l.getMinutes()),u={name:i.name,rank:ae(),score:e,time:s};u.name&&o(n.params.id,c,u)}},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){this.setCanvasSize()}},{key:"componentDidMount",value:function(){var e=this.props,t=e.match,a=e.location,n=e.fetchPlayingSongData,r=e.setInGameState,o=e.fetchRankingRecord,c=a.search.slice(1);n(t.params.id,c),o(t.params.id,c),function(e){var t=document.querySelector("#game-canvas").getContext("2d"),a=18*e,n=13*e;t.line=function(e,a,n,r,o){t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(a.x,a.y),t.strokeStyle=n,t.shadowBlur=60,t.shadowColor=r,t.lineWidth=o,t.stroke()};for(var r=0;r<5;r++)t.line({x:(r+7)*e,y:0},{x:18*e/4*r,y:13*e},"#000",null,1);t.beginPath(),t.moveTo(7*e,0),t.lineTo(11*e,0),t.lineTo(18*e,13*e),t.lineTo(0,13*e),t.closePath(),t.fillStyle="rgba(0,0,0,.8)",t.fill(),t.line({x:.5*e,y:12*e},{x:17.5*e,y:12*e},"rgba(142, 226, 163, 0.8)",null,2),t.save(),t.beginPath(),t.translate(a/2,n/2),t.textAlign="center",t.font="".concat(e,"px Courier New"),t.fillStyle="#fff",t.fillText("Click to Start",0,0),t.restore()}(this.state.unit);var i=document.querySelector(".player-canvas");i.addEventListener("click",function e(){return r(!0),i.removeEventListener("click",e),!1})}},{key:"componentDidUpdate",value:function(){var e=this,t=this.props,a=t.game,n=t.match,r=t.location,o=t.setGameOverState,c=t.auth,i=r.search.slice(1);if(a.playingSongData||function(e){var t=document.querySelector("#game-canvas").getContext("2d");t.clearRect(0,0,18*e,13*e),t.rect(0,0,18*e,13*e),t.fillStyle="#1d1d1d",t.fill();var a=18*e,n=13*e;t.save(),t.beginPath(),t.translate(a/2,n/2),t.textAlign="center",t.font="".concat(e,"px Courier New"),t.fillStyle="#fff",t.fillText("Coming Soon...",0,0),t.restore()}(this.state.unit),a.inGame&&a.playingSongData&&!a.gameOver){var l={name:c.name,totalNotes:0,hitNotesA:0,hitNotesB:0,hitNotesC:0,hitNotesD:0};localStorage.setItem("rankingData",JSON.stringify(l)),this.stopGame=re(this.state.unit,a.playingSongData.beatData,a.playingSongData.audio,i),a.playingSongData.audio.addEventListener("ended",function(){var t=e.countCurrentScore();e.stopGame(),o(!0),te(e.state.unit,t),e.storeRecord(t),document.querySelector(".player-canvas").addEventListener("click",function(){window.location.hash="#/ranking/".concat(n.params.id).concat(r.search)})})}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.setInGameState,a=e.setGameOverState,n=e.game;t(!1),a(!1),n.inGame&&n.playingSongData&&this.stopGame()}},{key:"render",value:function(){var e=this.state.unit,t={margin:"".concat(13*e+31,"px 0 0 0"),width:"".concat(18*e+1,"px")};return r.a.createElement("div",{className:"game-view"},r.a.createElement("div",{className:"game-wrap"},r.a.createElement("div",{className:"battle"},r.a.createElement(Z,{record:this.props.ranking.record}),r.a.createElement(q,null)),r.a.createElement("div",{className:"canvas-wrap"},r.a.createElement(Q,{width:18*e,height:13*e}),r.a.createElement("canvas",{className:"player-canvas",width:18*e,height:13*e})),r.a.createElement("div",{className:"game-buttons",style:t},r.a.createElement("div",{className:"game-btn btn-d"},"D"),r.a.createElement("div",{className:"game-btn btn-f"},"F"),r.a.createElement("div",{className:"game-btn btn-k"},"K"),r.a.createElement("div",{className:"game-btn btn-l"},"L"))))}}]),t}(r.a.Component)),ce=Object(i.b)(function(e){return{game:e.game,auth:e.auth,ranking:e.ranking}},{setInGameState:function(e){return{type:"SET_IN_GAME_STATE",payload:e}},fetchPlayingSongData:function(e,t){return function(a){var n={};K.collection("songList").doc(e).collection("gameData").get().then(function(e){e.forEach(function(e){n=Object.assign({audio:new Audio(e.data().url),beatData:JSON.parse(e.data()[t])}),a({type:"FETCH_PLAYING_SONG_DATA",payload:n})})}).catch(function(e){console.log("Error getting documents: ",e)})}},setGameOverState:function(e){return{type:"SET_GAME_OVER_STATE",payload:e}},storeRecordToDB:function(e,t,a){return function(n){K.collection("songList").doc(e).collection(t).add(a).then(function(){n({type:"STORE_RECORD"})}).catch(function(e){console.log(e.message)})}},fetchRankingRecord:z})(oe),ie=function(e){var t=e.currentRanking.totalNotes,a=e.currentRanking.hitNotesA+e.currentRanking.hitNotesB+e.currentRanking.hitNotesC+e.currentRanking.hitNotesD;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"current-ranking"},r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"TotalNotes"),r.a.createElement("div",null," ",t)),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"HIT"),r.a.createElement("div",null,a)),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"MISS"),r.a.createElement("div",null," ",t-a)),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"SCORE"),r.a.createElement("div",null," ",98*a)),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"ACCURATE"),r.a.createElement("div",null," ",Math.round(a/t*100)," %")),r.a.createElement("div",{className:"current-ranking-row"},r.a.createElement("div",null,"RANK"),r.a.createElement("div",null,ae()))))},le=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.rankingRecord.map(function(e){return r.a.createElement("div",{className:"record-board",key:e.id},r.a.createElement("div",{className:"record-item"}," ",e.data.name),r.a.createElement("div",{className:"record-item"}," ",e.data.score),r.a.createElement("div",{className:"record-item"}," ",e.data.rank),r.a.createElement("div",{className:"record-item"}," ",e.data.time))}))}}]),t}(r.a.Component),se=(a(190),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){localStorage.rankingData||(window.location.hash="#/");var e=this.props,t=e.match,a=e.location,n=e.fetchRankingRecord,r=a.search.slice(1);""!==r&&n(t.params.id,r)}},{key:"componentWillUnmount",value:function(){localStorage.removeItem("rankingData")}},{key:"render",value:function(){return r.a.createElement("div",{className:"ranking-view"},r.a.createElement("div",{className:"ranking-wrap"},localStorage.rankingData?r.a.createElement(ie,{currentRanking:JSON.parse(localStorage.rankingData)}):null,r.a.createElement("div",{className:"record"},r.a.createElement("div",{className:"record-board title"},r.a.createElement("div",{className:"record-item"}," Name"),r.a.createElement("div",{className:"record-item"}," Score"),r.a.createElement("div",{className:"record-item"}," Rank"),r.a.createElement("div",{className:"record-item"}," Date")),r.a.createElement(le,{rankingRecord:this.props.ranking.record}))))}}]),t}(r.a.Component)),ue=Object(i.b)(function(e){return{rankingData:e.rankingData,auth:e.auth,ranking:e.ranking}},{fetchRankingRecord:z})(se),me=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(g.a,null,r.a.createElement(T,null),r.a.createElement(M,null),r.a.createElement("div",null,r.a.createElement(f.a,{path:"/",exact:!0,component:B}),r.a.createElement(f.a,{path:"/select",component:Y}),r.a.createElement(f.a,{path:"/game/:id",component:ce}),r.a.createElement(f.a,{path:"/ranking/:id",component:ue})))}}]),t}(n.Component),de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_SONG_LIST":return t.payload;default:return e}},he=a(8),pe={loginForm:!1,signUpForm:!1,mobileButtons:!1},ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_LOGIN_FORM":return Object(he.a)({},e,{loginForm:t.payload});case"SHOW_SIGNUP_FORM":return Object(he.a)({},e,{signUpForm:t.payload});case"SHOW_MOBILE_BUTTONS":return Object(he.a)({},e,{mobileButtons:t.payload});case"LOGIN_SUCCESS":return Object(he.a)({},e,{loginForm:!1});case"SIGH_UP_SUCCESS":return Object(he.a)({},e,{signUpForm:!1});default:return e}},fe={authError:null,uid:null,name:null},Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return Object(he.a)({},e,{authError:"Login Failed"});case"GET_USER_UID":return Object(he.a)({},e,{uid:t.payload});case"LOGIN_SUCCESS":return e;case"SIGH_UP_SUCCESS":return Object(he.a)({},e,{authError:null});case"SIGH_UP_ERROR":return Object(he.a)({},e,{authError:t.payload});case"GET_USER_NAME":return Object(he.a)({},e,{name:t.payload});case"SHOW_LOGIN_FORM":case"SHOW_SIGNUP_FORM":return Object(he.a)({},e,{authError:null});default:return e}},be={record:[]},ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_RANKING_RECORD":return Object(he.a)({},e,{record:t.payload});default:return e}},ye={inGame:!1,playingSongData:null,gameOver:!1},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IN_GAME_STATE":return Object(he.a)({},e,{inGame:t.payload});case"FETCH_PLAYING_SONG_DATA":return Object(he.a)({},e,{playingSongData:t.payload});case"SET_GAME_OVER_STATE":return Object(he.a)({},e,{gameOver:t.payload});default:return e}},Oe=Object(l.c)({auth:Ee,showing:ge,songList:de,game:Se,ranking:ve}),Ne=Object(l.d)(Oe,Object(l.a)(s.a));c.a.render(r.a.createElement(i.a,{store:Ne},r.a.createElement(me,null)),document.getElementById("root"))},89:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfjBQEOGipNUDWeAAAAzElEQVRo3u3YPQ5BURCG4fegQbTYALUrsQIhEdthA9bjLwoKomcBJCo01FfQkKuwiO8W33MWMDNnppgMmJmJBSBHnbwg9psTH2hyJRG9C1FgT0vYgV0gpiRMIM6wFYaHLVSYEEsmIGZMWVq+mZlZKgSgT5uiIPaTDUsYyjbChIRB4EZV2IF7hkQYHr5ZAl1hAqMA9OiIhnDNSli8mZlZalSZ8ZCsYw+mVGAh3QnnKTjTHaUDcICIi6wBZxr/Y3WNgqD6Fye+0v83MwP4AccbjaeK1AN/AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTA1LTAxVDEyOjI2OjQyKzAyOjAwVQ1LxwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wNS0wMVQxMjoyNjo0MiswMjowMCRQ83sAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC"},91:function(e,t,a){e.exports=a(191)}},[[91,1,2]]]);
//# sourceMappingURL=main.204d94fa.chunk.js.map